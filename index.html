<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI MASTER - V30 ç»ˆæå…¨èƒ½è§†è§‰åˆ›ä½œçŸ©é˜µ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #050505; color: #fff; overflow-x: hidden; }
        #activation-modal { position: fixed; inset: 0; z-index: 9999; background: rgba(0,0,0,0.95); backdrop-filter: blur(20px); display: flex; align-items: center; justify-content: center; }
        .modal-card { background: #111; border: 1px solid rgba(245, 158, 11, 0.3); padding: 3rem; border-radius: 3rem; max-width: 450px; width: 95%; text-align: center; }
        .key-input { background: #000 !important; border: 2px solid #222 !important; color: #f59e0b !important; text-align: center; font-family: monospace; letter-spacing: 2px; text-transform: uppercase; }
        .tab-btn.active { background-color: #f59e0b; color: #000; box-shadow: 0 0 20px rgba(245, 158, 11, 0.4); }
        .gradient-border { border: 1px solid transparent; background: linear-gradient(#121212, #121212) padding-box, linear-gradient(45deg, #f59e0b, #78350f) border-box; }
        .custom-input { display: none; }
        .status-tag { font-size: 10px; background: rgba(245,158,11,0.1); color: #f59e0b; font-weight: bold; padding: 4px 12px; border-radius: 99px; border: 1px solid rgba(245,158,11,0.2); }
        .loading-dots:after { content: ' .'; animation: dots 1.5s steps(5, end) infinite; }
        @keyframes dots { 0%, 20% { content: ' .'; } 40% { content: ' ..'; } 60% { content: ' ...'; } 80%, 100% { content: ''; } }
    </style>
</head>
<body class="p-4 md:p-8">

    <!-- æ¿€æ´»å¼¹çª— -->
    <div id="activation-modal" style="display: none;">
        <div class="modal-card">
            <div class="w-20 h-20 bg-amber-500/10 rounded-full flex items-center justify-center mx-auto mb-8 border border-amber-500/20">
                <svg class="w-10 h-10 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/></svg>
            </div>
            <h2 class="text-2xl font-black text-white mb-3">äº‘ç«¯æˆæƒéªŒè¯</h2>
            <p id="modal-msg" class="text-gray-500 text-sm mb-10 leading-relaxed">è¯·è¾“å…¥æ‚¨çš„ 30 å¤©æ—¶é•¿å¡å¯†ã€‚<br>è¯¥å¡å¯†å°†ä¸æ‚¨çš„äº‘ç«¯è®°å½•æ°¸ä¹…ç»‘å®šã€‚</p>
            
            <input type="text" id="cd-key" class="key-input w-full p-5 mb-6 rounded-2xl text-xl font-bold" placeholder="V30-XXXX-XXXX">
            
            <button id="verify-btn" onclick="verifyKey()" class="w-full py-5 bg-amber-500 text-black font-black rounded-2xl hover:bg-amber-600 transition-all shadow-xl shadow-amber-500/20 mb-6 uppercase tracking-widest text-sm">
                ç«‹å³å¼€å¯äº‘ç«¯æ¿€æ´»
            </button>
            
            <a href="https://vince-zi.github.io/Ai-master/" class="text-amber-500/40 text-xs font-bold uppercase tracking-widest hover:text-amber-500">
                è¿˜æ²¡æœ‰å¡å¯†ï¼Ÿç‚¹å‡»è·å–æˆæƒ â†’
            </a>
        </div>
    </div>

    <!-- ä¸»ç•Œé¢ -->
    <div id="main-content" style="display: none;">
        <!-- ... åŸæœ‰å¤´éƒ¨å’Œå¸ƒå±€é€»è¾‘ä¿æŒä¸å˜ ... -->
        <div class="max-w-7xl mx-auto">
            <div class="flex flex-col md:flex-row justify-between items-center mb-16 gap-8">
                <div class="flex items-center gap-4">
                    <div class="w-14 h-14 bg-amber-500 rounded-2xl flex items-center justify-center shadow-lg"><svg class="w-8 h-8 text-black fill-current" viewBox="0 0 24 24"><path d="M13 10V3L4 14h7v7l9-11h-7z"/></svg></div>
                    <div><h1 class="text-4xl font-black italic tracking-tighter text-white">AI MASTER <span class="text-amber-500">V30</span></h1>
                    <div class="flex items-center gap-2 mt-1"><span class="status-tag" id="expiry-display">VIP Cloud Active</span></div></div>
                </div>
                <div class="flex bg-neutral-900/90 p-1.5 rounded-2xl border border-white/5 flex-wrap justify-center gap-1">
                    <button onclick="switchTab('portrait')" id="btn-portrait" class="tab-btn active px-8 py-3.5 rounded-xl text-sm font-black uppercase tracking-widest">å•†ä¸šäººåƒ</button>
                    <button onclick="switchTab('anime')" id="btn-anime" class="tab-btn px-8 py-3.5 rounded-xl text-sm font-black text-gray-500 uppercase tracking-widest">åŠ¨æ¼«CG</button>
                    <button onclick="switchTab('landscape')" id="btn-landscape" class="tab-btn px-8 py-3.5 rounded-xl text-sm font-black text-gray-500 uppercase tracking-widest">é£å…‰å»ºç­‘</button>
                    <button onclick="switchTab('commercial')" id="btn-commercial" class="tab-btn px-8 py-3.5 rounded-xl text-sm font-black text-gray-500 uppercase tracking-widest">å•†ä¸šæ‘„å½±</button>
                </div>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
                <div class="lg:col-span-2 space-y-8"><div id="track-content" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-12"><button onclick="generatePrompt()" class="py-5 bg-amber-500 text-black font-black rounded-2xl uppercase tracking-widest text-lg">ğŸš€ ç”Ÿæˆç»ˆææŒ‡ä»¤</button><button onclick="copyText()" class="py-5 bg-white/5 text-amber-500 font-bold rounded-2xl border border-white/10 uppercase tracking-widest text-lg">ä¸€é”®å¤åˆ¶</button></div></div>
                <div class="lg:col-span-1"><div class="sticky top-12 gradient-border p-8 rounded-[3.5rem] shadow-2xl relative overflow-hidden"><h3 class="text-xs font-black text-amber-500 uppercase tracking-[0.4em] mb-8">Prompt Output</h3><textarea id="result" readonly class="w-full h-[600px] bg-transparent border-none text-sm font-mono text-gray-400 leading-relaxed resize-none focus:ring-0" placeholder="æˆæƒå·²è§£é”"></textarea></div></div>
            </div>
        </div>
    </div>

    <script>
        async function verifyKey(manualKey = null) {
            const key = manualKey || document.getElementById('cd-key').value.trim().toUpperCase();
            if (!key) return;

            const btn = document.getElementById('verify-btn');
            const msg = document.getElementById('modal-msg');
            
            btn.innerText = "æ­£åœ¨åŒæ­¥äº‘ç«¯æ•°æ®...";
            btn.disabled = true;

            try {
                // å°è¯•è¯·æ±‚
                const response = await fetch('/api/verify', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ key })
                });

                const data = await response.json();

                if (response.ok) {
                    localStorage.setItem('v30_active_key', key);
                    localStorage.setItem('v30_expiry_time', data.expiry);
                    showApp(data.expiry);
                } else {
                    if (manualKey) { // å¦‚æœæ˜¯è‡ªåŠ¨æ ¡éªŒå¤±è´¥ï¼Œé™é»˜å¤„ç†
                        document.getElementById('activation-modal').style.display = 'flex';
                    } else {
                        alert("âŒ éªŒè¯å¤±è´¥ï¼š" + (data.error || "æœªçŸ¥é”™è¯¯"));
                    }
                }
            } catch (err) {
                // ç½‘ç»œé”™è¯¯é‡è¯•æœºåˆ¶
                console.warn("Retrying due to network issue...");
                setTimeout(() => {
                    if (!manualKey) alert("â˜ï¸ äº‘ç«¯æ­£åœ¨å”¤é†’ä¸­ï¼Œè¯·ç¨åå†æ¬¡ç‚¹å‡»æ¿€æ´»ã€‚");
                    btn.disabled = false;
                    btn.innerText = "ç«‹å³å¼€å¯äº‘ç«¯æ¿€æ´»";
                }, 1000);
            }
        }

        function showApp(expiry) {
            document.getElementById('activation-modal').style.display = 'none';
            document.getElementById('main-content').style.display = 'block';
            const daysLeft = Math.max(0, Math.ceil((expiry - Date.now()) / (1000 * 60 * 60 * 24)));
            document.getElementById('expiry-display').innerText = `VIP å‰©ä½™æ—¶é•¿: ${daysLeft} å¤©`;
            renderTrack();
        }

        async function checkAuth() {
            const savedKey = localStorage.getItem('v30_active_key');
            if (savedKey) {
                const savedExpiry = localStorage.getItem('v30_expiry_time');
                if (savedExpiry && Date.now() < parseInt(savedExpiry)) {
                    // å¦‚æœæœ¬åœ°è¿˜æ²¡è¿‡æœŸï¼Œå…ˆå±•ç¤ºç•Œé¢ï¼Œå†åå°åŒæ­¥
                    showApp(parseInt(savedExpiry));
                    verifyKey(savedKey); // åå°é™é»˜åŒæ­¥æœ€æ–°æ—¥æœŸ
                    return;
                }
            }
            document.getElementById('activation-modal').style.display = 'flex';
        }

        // --- ä¸šåŠ¡é€»è¾‘ (åŸæœ‰é€»è¾‘) ---
        const trackData = {
            portrait: { title: "å•†ä¸šäººåƒ", categories: [ { label: "01. è§’è‰²ä¸»ä½“", type: "input", id: "subject", val: "ä¸€ä½å……æ»¡æ°”è´¨çš„äºšè£”å¥³æ€§æ¨¡ç‰¹" }, { label: "02. ç”»é¢æ„å›¾", type: "select", id: "p2", options: ["ä¸­å¿ƒæ„å›¾ (Centralized)", "ä¸Šä¸­ä¸‹æ‹¼å›¾", "ä¸‰åˆ†æ³•", "é»„é‡‘æ¯”ä¾‹", "å¯¹ç§°æ„å›¾", "âœï¸ è‡ªå®šä¹‰"] }, { label: "03. æ‹æ‘„ç¯å¢ƒ", type: "input", id: "p3", val: "å¤å¤çš„æ¬§æ´²å›¾ä¹¦é¦†" }, { label: "04. æ ¸å¿ƒæœºä½", type: "select", id: "p4", options: ["å¹³è§†", "ä»°æ‹", "ä¿¯æ‹", "è·å…°ä½", "æå°½ç‰¹å†™", "âœï¸ è‡ªå®šä¹‰"] }, { label: "05. ç›¸æœºå“ç‰Œ", type: "select", id: "p5", options: ["å“ˆè‹ (X2D)", "å¾•å¡ (M11-P)", "é£æ€ (IQ4)", "å¯Œå£« (GFX)", "ä½³èƒ½ (R3)", "âœï¸ è‡ªå®šä¹‰"] }, { label: "06. ç„¦æ®µé€‰æ‹©", type: "select", id: "p6", options: ["85mm", "35mm", "50mm", "135mm", "âœï¸ è‡ªå®šä¹‰"] }, { label: "07. å…‰åœˆè®¾ç½®", type: "select", id: "p7", options: ["f/1.2", "f/1.4", "f/2.8", "f/8.0", "âœï¸ è‡ªå®šä¹‰"] }, { label: "08. ç¯å…‰å“ç‰Œ", type: "select", id: "p8", options: ["å¸ƒæœ— (Broncolor)", "ä¿å¯Œå›¾ (Profoto)", "é˜¿è± (Arri)", "è‡ªç„¶çª—å…‰", "âœï¸ è‡ªå®šä¹‰"] }, { label: "09. å¸ƒå…‰æ–¹æ¡ˆ", type: "select", id: "p9", options: ["ä¼¦å‹ƒæœ—å…‰", "è´è¶å…‰", "ä¾§ä½å…‰", "è½®å»“å…‰", "ä¸è¾¾å°”æ•ˆåº”", "âœï¸ è‡ªå®šä¹‰"] }, { label: "10. æ§å…‰é™„ä»¶", type: "select", id: "p10", options: ["å…«è§’æŸ”å…‰ç®±", "é›·è¾¾ç½©", "æŸå…‰ç­’", "åå…‰æ¿", "âœï¸ è‡ªå®šä¹‰"] }, { label: "11. è§†è§‰å…ƒç´ ", type: "select", id: "p11", options: ["æ— ", "æ‚¬æµ®èŠ±ç“£", "å¼¥æ¼«çƒŸé›¾", "é•œé¢åå°„", "âœï¸ è‡ªå®šä¹‰"] }, { label: "12. çš®è‚¤è´¨æ„Ÿ", type: "select", id: "p12", options: ["æè‡´æ¯›å­”", "æ¹¿æ¶¦è´¨æ„Ÿ", "ä¸æ»‘æ¶¦é¥°", "èƒ¶ç‰‡é¢—ç²’", "âœï¸ è‡ªå®šä¹‰"] }, { label: "13. ç¾å­¦é£æ ¼", type: "select", id: "p13", options: ["æƒ…æ„ŸçœŸå®ä¸»ä¹‰", "æ–°ä¸­å¼", "å¤å…¸æ²¹ç”»", "é»‘è‰²ç”µå½±", "æç®€ä¸»ä¹‰", "âœï¸ è‡ªå®šä¹‰"] }, { label: "14. è‰²å½©è°ƒæ€§", type: "select", id: "p14", options: ["é«˜é€æ¨¡å¼", "æŸ¯è¾¾ 400", "ç”µå½±é’æ©™", "ç‹å®¶å«é£æ ¼", "âœï¸ è‡ªå®šä¹‰"] }, { label: "15. å•†ä¸šæ’ç‰ˆ", type: "select", id: "p15", options: ["æ— ", "VOGUE å°é¢", "æ—¶å°šèŠ­è", "ç”µå½±æµ·æŠ¥", "âœï¸ è‡ªå®šä¹‰"] }, { label: "16. ä¸ªäººç½²å", type: "input", id: "p16", val: "Created by Master" } ] },
            anime: { title: "åŠ¨æ¼«CG", categories: [ { label: "01. è§’è‰²ä¸»ä½“", type: "input", id: "subject", val: "é“¶å‘æœºæ¢°æ­¦è£…å°‘å¥³" }, { label: "02. ç¯å¢ƒç»“æ„", type: "input", id: "environment", val: "èµ›åšéœ“è™¹ä¸‹çš„ä¸œäº¬åºŸå¢Ÿ" }, { label: "03. é£æ ¼ç±»å‹", type: "select", id: "style_type", options: ["-- è¯·é€‰æ‹© --", "ç»å…¸èµ›ç’ç", "æ–°æµ·è¯šæ²»æ„ˆç³»", "äº¬é˜¿å°¼å”¯ç¾", "å®«å´éªå‰åœåŠ›", "æµ®ä¸–ç»˜", "å…‰ç”µ/å…‰æ•ˆé£", "è™šå¹»5 CGæ¸²æŸ“", "90å¹´ä»£å¤å¤", "è’¸æ±½æ³¢", "è¿ªå£«å°¼3D", "âœï¸ è‡ªå®šä¹‰"] }, { label: "04. ç”»é£æµæ´¾", type: "select", id: "a4", options: ["äº¬é˜¿å°¼", "æ–°æµ·è¯š", "å‰åœåŠ›", "MAPPA", "90s èµ›ç’ç", "è™šå¹»5æè‡´", "èµ›åšæœ‹å…‹", "è¿ªå£«å°¼3D", "âœï¸ è‡ªå®šä¹‰"] }, { label: "05. çº¿æ¡ç¬”è§¦", type: "select", id: "a5", options: ["ç»†è…»å¢¨çº¿", "æ— æè¾¹åšæ¶‚", "ç²—çŠ·è‰å›¾", "æ¯›ç¬”å‹¾å‹’", "âœï¸ è‡ªå®šä¹‰"] }, { label: "06. ä¸Šè‰²å·¥è‰º", type: "select", id: "a6", options: ["èµ›ç’ç", "æ¢¦å¹»æ°´å½©", "å†™å®åšæ¶‚", "ä¸‰æ¸²äºŒ", "âœï¸ è‡ªå®šä¹‰"] }, { label: "07. è§†è§’æ„å›¾", type: "select", id: "a7", options: ["ä»°è§†ä½æœºä½", "å…¨æ™¯ä¿¯ç°", "é»„é‡‘æ¯”ä¾‹", "ä¸‰å±‚çº§æ‹¼å›¾", "âœï¸ è‡ªå®šä¹‰"] }, { label: "08. æ°›å›´ç‰¹æ•ˆ", type: "select", id: "a8", options: ["æ²»æ„ˆ", "å†·é…·", "é­”æ³•ç¬¦æ–‡", "ç²’å­å…‰æ–‘", "æ¼«ç”»é€Ÿçº¿", "ç’€ç’¨æ˜Ÿç³", "âœï¸ è‡ªå®šä¹‰"] }, { label: "09. ä¸ªäººç½²å", type: "input", id: "a9", val: "Art by AI Master" } ] },
            landscape: { title: "é£å…‰å»ºç­‘", categories: [ { label: "01. æ ¸å¿ƒæ™¯è§‚", type: "input", id: "subject", val: "æœªæ¥çš„æ°´ä¸Šç§‘å¹»éƒ½å¸‚" }, { label: "02. ç¯å¢ƒç»†èŠ‚", type: "input", id: "l2", val: "äº‘é›¾ç¼­ç»•çš„é«˜å±±" }, { label: "03. æ‹æ‘„æ—¶æ®µ", type: "select", id: "l3", options: ["é»„é‡‘æ—¶åˆ»", "è“è‰²æ—¶åˆ»", "åˆå¤œé“¶æ²³", "æ™¨æ›¦è–„é›¾", "âœï¸ è‡ªå®šä¹‰"] }, { label: "04. æ„å›¾æ³•åˆ™", type: "select", id: "l4", options: ["å¼•å¯¼çº¿", "ä¸‰åˆ†æ³•", "å¯¹ç§°å€’å½±", "æç®€ç•™ç™½", "âœï¸ è‡ªå®šä¹‰"] }, { label: "05. ç›¸æœºç³»ç»Ÿ", type: "select", id: "l5", options: ["é£æ€XT", "å¤§ç–†èˆªæ‹", "ç´¢å°¼Alpha", "å¾•å¡SL", "âœï¸ è‡ªå®šä¹‰"] }, { label: "06. è‰²å½©é£æ ¼", type: "select", id: "l8", options: ["å›½å®¶åœ°ç†", "æŸ¯è¾¾é£å…‰", "èµ›åšæœªæ¥", "æ°´å¢¨å±±æ°´", "âœï¸ è‡ªå®šä¹‰"] }, { label: "07. ä¸ªäººç½²å", type: "input", id: "l9", val: "Photo by Explorer" } ] },
            commercial: { title: "å•†ä¸šæ‘„å½±", categories: [ { label: "01. äº§å“ä¸»ä½“", type: "input", id: "c1", val: "ç™½åº•é’èŠ±ç“·é£æ ¼å¥¶èŒ¶æ¯" }, { label: "02. æè´¨è´¨æ„Ÿ", type: "select", id: "c3", options: ["ç»†è…»é™¶ç“·", "æ™¶è¹ç»ç’ƒ", "æ‹‰ä¸é‡‘å±", "âœï¸ è‡ªå®šä¹‰"] }, { label: "03. å¸ƒå…‰æ–¹æ¡ˆ", type: "select", id: "c4", options: ["è‡ªç„¶çª—å…‰", "é¡¶éƒ¨è½®å»“å…‰", "ç¯ç»•æŸ”å…‰", "âœï¸ è‡ªå®šä¹‰"] }, { label: "04. æœ€ç»ˆå¯¼å‡º", type: "input", id: "c7", val: "8K Advertising Masterpiece" } ] }
        };

        let currentTab = 'portrait';
        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.tab-btn').forEach(btn => { btn.classList.remove('active', 'text-black'); btn.classList.add('text-gray-500'); });
            document.getElementById('btn-' + tab).classList.add('active', 'text-black');
            document.getElementById('btn-' + tab).classList.remove('text-gray-500');
            renderTrack();
        }

        function renderTrack() {
            const data = trackData[currentTab];
            const content = document.getElementById('track-content');
            let html = "";
            data.categories.forEach((cat) => {
                html += `<div class="bg-neutral-900/50 rounded-3xl overflow-hidden border border-white/5"><div class="bg-amber-500/10 px-6 py-3 border-b border-white/5"><label class="text-[11px] font-black text-amber-500 uppercase tracking-widest">${cat.label}</label></div><div class="p-5">`;
                if (cat.type === 'input') html += `<input type="text" id="${cat.id}" value="${cat.val}" class="w-full p-4 text-sm font-bold">`;
                else {
                    html += `<select id="${cat.id}" class="w-full p-4 text-sm font-bold cursor-pointer" onchange="checkCustom(this)">`;
                    cat.options.forEach(opt => html += `<option value="${opt}">${opt}</option>`);
                    html += `</select><input type="text" id="${cat.id}_custom" class="w-full p-4 mt-4 text-sm font-bold custom-input border-amber-500/50 bg-amber-500/5" placeholder="è¯·è¾“å…¥ç»†èŠ‚...">`;
                }
                html += `</div></div>`;
            });
            content.innerHTML = html;
        }

        function checkCustom(select) {
            const customInput = document.getElementById(select.id + '_custom');
            if (select.value && select.value.includes("è‡ªå®šä¹‰")) { customInput.style.display = 'block'; customInput.focus(); }
            else if (customInput) customInput.style.display = 'none';
        }

        function generatePrompt() {
            const data = trackData[currentTab];
            let parts = [];
            data.categories.forEach(cat => {
                const el = document.getElementById(cat.id);
                const custom = document.getElementById(cat.id + '_custom');
                let val = (el.value.includes("è‡ªå®šä¹‰")) ? custom.value : (el.value.match(/\(([^)]+)\)/) ? el.value.match(/\(([^)]+)\)/)[1] : el.value);
                if (val && !val.includes("è¯·é€‰æ‹©") && val !== "") parts.push(val);
            });
            document.getElementById('result').value = parts.join(', ') + ", masterpiece, 8k resolution --ar 9:16 --v 6.0";
        }

        async function copyText() {
            const res = document.getElementById("result");
            if(!res.value) return;
            try { await navigator.clipboard.writeText(res.value); alert("âœ… å·²å¤åˆ¶ï¼"); }
            catch (err) { res.select(); document.execCommand("copy"); alert("âœ… å·²å¤åˆ¶ï¼"); }
        }

        window.onload = checkAuth;
    </script>
</body>
</html>